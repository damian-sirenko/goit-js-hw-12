{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const galleryMarkup = images => {\n  return images\n    .map(\n      ({\n        id,\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<div class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\" id=\"${id}\" />\n          </a>\n          <div class=\"img-props\">\n            <div class=\"item-props\">\n              <h3 class=\"item-title-props\">Likes</h3>\n              <p class=\"item-value-props\">${likes}</p>\n            </div>\n            <div class=\"item-props\">\n              <h3 class=\"item-title-props\">Views</h3>\n              <p class=\"item-value-props\">${views}</p>\n            </div>\n            <div class=\"item-props\">\n              <h3 class=\"item-title-props\">Comments</h3>\n              <p class=\"item-value-props\">${comments}</p>\n            </div>\n            <div class=\"item-props\">\n              <h3 class=\"item-title-props\">Downloads</h3>\n              <p class=\"item-value-props\">${downloads}</p>\n            </div> \n          </div>\n        </div>`\n    )\n    .join('');\n};\n","import axios from 'axios';\n\nconst API_KEY = '43948789-3afe6d8ecc2e5aa705550f4b3';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const searchingPhotosByQuery = async (serachQuery, page) => {\n\tconst response = await axios.get('/', {\n\t\tparams: {\n\t\t\tkey: API_KEY,\n\t\t\tq: serachQuery,\n\t\t\timage_type: 'photo',\n\t\t\torientation: 'horizontal',\n\t\t\tsafesearch: true,\n\t\t\tpage: page,\n\t\t\tper_page: 15,\n\t\t}\n\t})\n\treturn response.data\n\n};","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { galleryMarkup } from './js/render-functions.js';\nimport { searchingPhotosByQuery } from './js/pixabay-api.js';\n\nconst searchFormEl = document.querySelector('.search-form');\nlet galleryEl = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nlet totalPages = 0;\nlet searchQuery = '';\nlet currentPage = 1;\nconst per_page = 15;\n\nconst handleSubmit = async event => {\n  event.preventDefault();\n  const form = event.currentTarget;\n  searchQuery = form.elements.search.value.trim();\n\n  galleryEl.innerHTML = '';\n  loaderEl.classList.remove('is-hidden');\n  currentPage = 1;\n\n  if (searchQuery === '') {\n    iziToast.show({\n      message: 'Input field can not be empty',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    form.reset();\n    loaderEl.classList.add('is-hidden');\n\n    return;\n  }\n\n  try {\n    const { total, hits } = await searchingPhotosByQuery(\n      searchQuery,\n      currentPage\n    );\n\n    if (total === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n      loaderEl.classList.add('is-hidden');\n      loadMoreBtnEl.classList.add('btn-is-hidden');\n\n      return;\n    }\n\n    galleryEl.insertAdjacentHTML('beforeend', galleryMarkup(hits));\n    loadMoreBtnEl.classList.remove('btn-is-hidden');\n\n    totalPages = Math.ceil(total / per_page);\n\n    if (hits.length < per_page) {\n      loadMoreBtnEl.classList.add('btn-is-hidden');\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n    } else {\n      loadMoreBtnEl.classList.remove('btn-is-hidden');\n    }\n    lightbox.refresh();\n  } catch {\n    iziToast.show({\n      message: 'An error occurred while fetching images',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n  form.reset();\n};\n\nconst smoothScroll = () => {\n  const lastItemEl = galleryEl.querySelector('.gallery-item:last-child');\n  const imageItemHeight = lastItemEl.getBoundingClientRect().height;\n  const scrollHeight = imageItemHeight * 2;\n\n  window.scrollBy({\n    top: 1000,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nasync function onLoadMorePressed(event) {\n  try {\n    currentPage += 1;\n    loaderEl.classList.remove('is-hidden');\n\n    const { hits } = await searchingPhotosByQuery(searchQuery, currentPage);\n\n    galleryEl.insertAdjacentHTML('beforeend', galleryMarkup(hits));\n\n    lightbox.refresh();\n    smoothScroll();\n\n    if (currentPage >= totalPages) {\n      loadMoreBtnEl.classList.add('btn-is-hidden');\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n    }\n  } catch (error) {\n    iziToast.show({\n      message: 'An error occurred while fetching more images.',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    loadMoreBtnEl.classList.add('btn-is-hidden');\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nloadMoreBtnEl.addEventListener('click', onLoadMorePressed);\nsearchFormEl.addEventListener('submit', handleSubmit);\n\n"],"names":["galleryMarkup","images","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","API_KEY","axios","searchingPhotosByQuery","serachQuery","page","searchFormEl","galleryEl","loaderEl","loadMoreBtnEl","totalPages","searchQuery","currentPage","per_page","handleSubmit","event","form","iziToast","total","hits","lightbox","smoothScroll","onLoadMorePressed","SimpleLightbox"],"mappings":"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"}